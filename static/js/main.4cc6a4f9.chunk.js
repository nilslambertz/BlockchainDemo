(this.webpackJsonpblockchaindemo=this.webpackJsonpblockchaindemo||[]).push([[0],{15:function(t,e,n){},20:function(t,e,n){},27:function(t,e,n){},28:function(t,e,n){},29:function(t,e,n){},31:function(t,e,n){},39:function(t,e){},43:function(t,e,n){"use strict";n.r(e);var a=n(0),s=n.n(a),r=n(7),o=n.n(r),c=(n(27),n(10)),i=n(2),l=n(3),d=n(5),u=n(4),p=(n(28),n(6)),b=(n(15),n(29),n(1)),f=function(t){Object(d.a)(n,t);var e=Object(u.a)(n);function n(){return Object(i.a)(this,n),e.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(b.jsx)("div",{className:"account listElement",children:Object(b.jsx)("table",{className:"accountTable listTable",children:Object(b.jsxs)("tbody",{children:[Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{className:"id",children:this.props.account.id}),Object(b.jsx)("td",{className:"privateKey smallText",children:this.props.account.privateKey}),Object(b.jsx)("td",{className:"address smallText",children:this.props.account.address}),Object(b.jsx)("td",{className:"balance",children:this.props.account.balanceBeforeBlock[this.props.lastConfirmedBlock+1]})]}),Object(b.jsxs)("tr",{className:"description",children:[Object(b.jsx)("td",{children:"ID"}),Object(b.jsx)("td",{children:"Private Key"}),Object(b.jsx)("td",{children:"Address"}),Object(b.jsx)("td",{children:"Balance"})]})]})})})}}]),n}(s.a.Component),h=(n(31),n(8)),j=n(11),v={backgroundColor:"#FF5226"},m={position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!1,progress:void 0,style:v};function O(t){j.b.error(t,m)}var g,x=function(t){Object(d.a)(n,t);var e=Object(u.a)(n);function n(){var t;Object(i.a)(this,n);for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(t=e.call.apply(e,[this].concat(s))).state={from:0,to:0,amount:0},t.sign=function(){if(-1!==t.state.from&&-1!==t.state.to&&-1!==t.state.amount){var e=t.props.transaction;e.from=t.state.from,e.to=t.state.to,e.amount=t.state.amount,t.props.signFunction(e)}else O("All values must be set to sign a transaction!")},t}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var t=this.props.transaction;void 0!==t.from&&void 0!==t.to&&void 0!==t.amount&&this.setState({from:t.from,to:t.to,amount:t.amount})}},{key:"render",value:function(){var t=this;return Object(b.jsx)(h.b,{draggableId:"transaction"+this.props.transaction.id,index:this.props.index,children:function(e,n){return Object(b.jsx)("div",Object(p.a)(Object(p.a)(Object(p.a)({className:"transaction listElement"+(n.isDragging?" transactionDragging":""),ref:e.innerRef},e.draggableProps),e.dragHandleProps),{},{children:Object(b.jsx)("table",{className:"transactionTable listTable",children:Object(b.jsxs)("tbody",{children:[Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{className:"id",children:t.props.transaction.id}),Object(b.jsx)("td",{className:"from"+(t.props.transaction.editable?"":" biggerText"),children:t.props.transaction.editable?Object(b.jsx)("select",{className:"selectStyle",value:t.state.from,onChange:function(e){var n=parseInt(e.target.value);t.state.from!==n&&(t.props.removeSignatureFunction(t.props.transaction.id),t.setState({from:n}))},children:Array.from(Array(t.props.numberOfAccounts).keys()).map((function(t){return Object(b.jsx)("option",{value:t,children:t},t)}))}):t.props.transaction.from}),Object(b.jsx)("td",{className:"to"+(t.props.transaction.editable?"":" biggerText"),children:t.props.transaction.editable?Object(b.jsx)("select",{className:"selectStyle",value:t.state.to,onChange:function(e){var n=parseInt(e.target.value);t.state.to!==n&&(t.props.removeSignatureFunction(t.props.transaction.id),t.setState({to:n}))},children:Array.from(Array(t.props.numberOfAccounts).keys()).map((function(t){return Object(b.jsx)("option",{value:t,children:t},t)}))}):t.props.transaction.to}),Object(b.jsx)("td",{className:"amount",children:t.props.transaction.editable?Object(b.jsx)("input",{type:"number",className:"amountInput",min:"0",max:"1000",value:t.state.amount,onChange:function(e){var n=parseInt(e.target.value);isNaN(n)||(t.state.amount!==n&&t.props.removeSignatureFunction(t.props.transaction.id),t.setState({amount:n}))}}):t.props.transaction.amount}),Object(b.jsx)("td",{className:"signature"+(t.props.transaction.signed?" smallText":""),children:t.props.transaction.signed?t.props.transaction.signature:Object(b.jsx)("div",{className:"signButton",onClick:function(){return t.sign()},children:"Sign"})})]}),Object(b.jsxs)("tr",{className:"description",children:[Object(b.jsx)("td",{children:"ID"}),Object(b.jsx)("td",{children:"From"}),Object(b.jsx)("td",{children:"To"}),Object(b.jsx)("td",{children:"Amount"}),Object(b.jsx)("td",{children:"Signature"})]})]})})}))}})}}]),n}(s.a.Component),k=function(t){Object(d.a)(n,t);var e=Object(u.a)(n);function n(){var t;Object(i.a)(this,n);for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(t=e.call.apply(e,[this].concat(s))).printAccountList=function(e){var n,a=null!==(n=t.props.lastConfirmedBlock)&&void 0!==n?n:-1;return 0===e.length?Object(b.jsx)("div",{style:{color:"#575757"},children:t.props.emptyText}):e.map((function(t,e,n){return Object(b.jsx)(f,{account:t,lastConfirmedBlock:a},t.id)}))},t.printTransactionList=function(e){var n,a=0;(null===(n=t.props)||void 0===n?void 0:n.numberOfAccounts)&&(a=t.props.numberOfAccounts);var s=t.props.transactionOrder;void 0===s&&(s=[]);var r=t.props.signFunction,o=t.props.removeSignatureFunction;return 0===s.length?Object(b.jsx)("div",{style:{color:"#575757"},children:t.props.emptyText}):s.map((function(t,n,s){return Object(b.jsx)(x,{transaction:e[t],numberOfAccounts:a,signFunction:r,removeSignatureFunction:o,index:n},t)}))},t}return Object(l.a)(n,[{key:"render",value:function(){var t=function(t){return Object(b.jsx)("div",{className:"listError",children:t})},e="Error";this.props.accounts?(t=this.printAccountList,e=this.props.accounts):this.props.transactions&&(t=this.printTransactionList,e=this.props.transactions);var n=this.props.addFunction;return n||(n=function(){console.log("Error: function is not defined")}),Object(b.jsxs)("div",{className:"upperListContainer "+this.props.className,children:[this.props.blockList?"":Object(b.jsx)("div",{className:"upperListTitle",children:this.props.title}),Object(b.jsx)(h.c,{droppableId:this.props.droppableId,isDropDisabled:this.props.dropDisabled,children:function(n,a){return Object(b.jsxs)("div",Object(p.a)(Object(p.a)({ref:n.innerRef},n.droppableProps),{},{className:"upperList",style:{backgroundColor:a.isDraggingOver?"rgba(255,255,255,0.05)":""},children:[t(e),n.placeholder]}))}}),this.props.blockList?"":Object(b.jsx)("div",{className:"addButtonContainer",children:Object(b.jsx)("div",{className:"addButton",onClick:function(){return n()},children:"Add"})})]})}}]),n}(s.a.Component),y="0".repeat(3),N=n(9),C=(n(20),function(t){Object(d.a)(n,t);var e=Object(u.a)(n);function n(){var t;Object(i.a)(this,n);for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(t=e.call.apply(e,[this].concat(s))).printTransactionList=function(){return Object(b.jsx)(k,{droppableId:"block"+t.props.block.id,title:"transactions",transactions:t.props.transactions,transactionOrder:t.props.block.transactions,className:"transactionListContainer",emptyText:"Drag and drop transactions here!",blockList:!0})},t.confirmFunction=function(){t.props.confirmFunction(t.props.block.id)},t}return Object(l.a)(n,[{key:"render",value:function(){var t,e,n,a,s,r=this;return Object(b.jsx)("div",{className:"blockContainer",children:Object(b.jsxs)("div",{className:"block",children:[Object(b.jsxs)("div",{className:"prevHash blockSmallText",children:[null===(t=this.props.block)||void 0===t?void 0:t.prevHash,Object(b.jsx)("div",{className:"blockDescription",children:"Previous hash"})]}),Object(b.jsxs)("div",{className:"transactions",children:[Object(b.jsx)("div",{className:"transactionList",children:this.printTransactionList()}),Object(b.jsx)("div",{className:"blockDescription",children:"Transactions"})]}),Object(b.jsxs)("div",{className:"nonce",children:[null===(e=this.props.block)||void 0===e?void 0:e.nonce,Object(b.jsx)("div",{className:"blockDescription",children:"Nonce"})]}),Object(b.jsxs)("div",{className:"confirmContainer",children:[this.props.block.confirmed?Object(b.jsx)("span",{className:"confirmedString",children:"confirmed"}):Object(b.jsx)("div",{className:"confirmButton",onClick:function(){return r.confirmFunction()},children:"Confirm"}),Object(b.jsx)("div",{className:"blockDescription",children:"Confirmation"})]}),Object(b.jsxs)("div",{className:"hash blockSmallText",children:[this.props.block.confirmed?Object(b.jsxs)("span",{children:[Object(b.jsx)("span",{className:"confirmedString",children:y}),null===(n=this.props.block)||void 0===n||null===(a=n.hash)||void 0===a?void 0:a.substr(y.length)]}):null===(s=this.props.block)||void 0===s?void 0:s.hash,Object(b.jsx)("div",{className:"blockDescription",children:"Hash"})]})]})})}}]),n}(s.a.Component)),A=["title","titleId"];function B(){return(B=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t}).apply(this,arguments)}function S(t,e){if(null==t)return{};var n,a,s=function(t,e){if(null==t)return{};var n,a,s={},r=Object.keys(t);for(a=0;a<r.length;a++)n=r[a],e.indexOf(n)>=0||(s[n]=t[n]);return s}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(a=0;a<r.length;a++)n=r[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function I(t,e){var n=t.title,s=t.titleId,r=S(t,A);return a.createElement("svg",B({xmlns:"http://www.w3.org/2000/svg",id:"Layer_1",enableBackground:"new 0 0 150 50",xmlSpace:"preserve",viewBox:"0 0 150 50",y:"0px",x:"0px",ref:e,"aria-labelledby":s},r),n?a.createElement("title",{id:s},n):null,g||(g=a.createElement("g",null,a.createElement("line",{y2:24.704,x1:1.266,x2:125.3,stroke:"white",strokeMiterlimit:10,y1:24.704,strokeWidth:6}),a.createElement("polygon",{points:"124.4 6.284 124.4 44.606 148.35 23.69",stroke:"white",fill:"white"}))))}var T=a.forwardRef(I),w=(n.p,function(t){Object(d.a)(n,t);var e=Object(u.a)(n);function n(){var t;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))).printBlocks=function(){var e=t.props.transactions,n=t.props.confirmFunction;return t.props.blocks.map((function(t,a,r){return Object(b.jsxs)(s.a.Fragment,{children:[Object(b.jsx)(C,{block:t,transactions:e,confirmFunction:n}),a!==r.length-1?Object(b.jsx)("div",{className:"arrows",children:Object(b.jsx)(T,{})}):""]},a)}))},t}return Object(l.a)(n,[{key:"render",value:function(){return Object(b.jsx)("div",{className:"blockchain",children:this.printBlocks()})}}]),n}(s.a.Component)),F=(n(42),n(12)),L=function(t){Object(d.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(i.a)(this,n),(a=e.call(this,t)).addAccount=function(){var t=Object(N.c)(),e=a.state.accountIdCount,n=Math.floor(1001*Math.random()),s={id:e,privateKey:t.privateKey,privateKeyArray:t.privateKeyArray,address:t.address,addressArray:t.addressArray,balanceBeforeBlock:Array(a.state.lastConfirmedBlock+2).fill(n)};a.setState({accountIdCount:e+1});var r=a.state.accounts;r.push(s),a.setState({accounts:r})},a.addTransaction=function(){var t=a.state.transactionIdCount,e={id:t,signed:!1,editable:!0};a.setState({transactionIdCount:t+1});var n=a.state.transactions,s=a.state.unusedTransactions;n.push(e),s.push(e.id),a.setState({transactions:n,unusedTransactions:s})},a.signTransaction=function(t){if(0!==a.state.accounts.length)if(void 0!==t.from&&void 0!==t.to){var e=t.from,n=a.state.accounts[e].privateKeyArray,s=a.state.accounts[e].addressArray;if(-1!==e&&void 0!==n&&void 0!==s){var r=Object(N.d)(t,n),o=a.state.transactions;o[t.id].signed=!0,o[t.id].signatureArray=r.signatureArray,o[t.id].signature=r.signature,a.setState({transactions:o})}}else O("All values have to be set to sign a transaction!");else O("At least one account is needed to set all transaction values!")},a.removeSignature=function(t){var e=a.state.transactions,n=e[t];n.signed=!1,n.signatureArray=void 0,n.signature=void 0,e[t]=n,a.setState({transactions:e})},a.recalculateBlocks=function(){var t=Object(c.a)(a.state.blocks),e=Object(c.a)(a.state.transactions),n=a.state.lastUnusedBlock,s=a.state.blockIdCount;(t[t.length-1].confirmed||0!==t[t.length-1].transactions.length)&&(t.push({id:s,nonce:0,transactions:[],confirmed:!1}),n=s++);for(var r=!1,o=a.state.lastConfirmedBlock,i=0;i<t.length;i++){var l=Object(N.b)(t[i],e);if(""===l)return void console.log("Error while generating hash, see previous error-messages!");l!==t[i].hash&&(!r&&o>i-1&&(o=i-1),r=!0),r&&(t[i].confirmed=!1),t[i].hash=l,i!==t.length-1&&(t[i+1].prevHash=l)}a.setState({blocks:t,lastUnusedBlock:n,lastConfirmedBlock:o,blockIdCount:s})},a.confirmBlock=function(t){var e,n=Object(c.a)(a.state.blocks),s=Object(c.a)(a.state.transactions),r=Object(c.a)(a.state.accounts);if(0!==t&&!n[t-1].confirmed)return e="All previous blocks need to be confirmed first!",void j.b.warn(e,Object(p.a)(Object(p.a)({},m),{},{style:v}));if(Object(N.e)(n[t],s,r)){for(var o=[],i=0;i<r.length;i++)o[i]=r[i].balanceBeforeBlock[t];for(var l=0;l<n[t].transactions.length;l++){var d=s[n[t].transactions[l]];if(void 0===d.from||void 0===d.to||void 0===d.amount)return;if(o[d.from]-d.amount<0){O("Transaction "+d.id+" could not be confirmed, account "+d.from+" doesn't have enough balance for this transaction!");for(var u=0;u<r.length;u++)r[u].balanceBeforeBlock=r[u].balanceBeforeBlock.slice(0,t+1);return void a.setState({accounts:r})}o[d.from]=o[d.from]-d.amount,o[d.to]=o[d.to]+d.amount}for(var b=0;b<r.length;b++)r[b].balanceBeforeBlock[t+1]=o[b];var f="",h=n[t],g=-1,x=Object(N.a)(h,s);do{g++,f=Object(F.sha256)(x+g)}while(!f.startsWith(y)&&g<1e6);if(g>=1e6&&!f.startsWith(y))return O("Could not validate block!"),void console.log("Didn't find nonce in 10000 iterations");h.nonce=g,h.confirmed=!0,h.hash=f,n[t]=h,a.setState({blocks:n,lastConfirmedBlock:h.id,accounts:r},(function(){a.recalculateBlocks()}))}else O("Some transactions could not be verified!")},a.onDragEnd=function(t){var e=t.destination,n=t.source,s=t.draggableId;if(null!==t.destination&&(e.droppableId!==n.droppableId||e.index!==n.index)){var r=t.source.index,o=t.destination.index,c=parseInt(s.replace("transaction","")),i=a.state.transactions,l=a.state.unusedTransactions,d=a.state.blocks;if("transactionList"===t.destination.droppableId)if("transactionList"===t.source.droppableId)l.splice(r,1),l.splice(o,0,c),a.setState({unusedTransactions:l});else{var u=t.source.droppableId.replace("block","");d[parseInt(u)].transactions.splice(r,1),l.splice(o,0,c),i[c].editable=!0,a.setState({blocks:d,unusedTransactions:l,transactions:i})}else if("transactionList"===t.source.droppableId){var p=a.state.transactions;if(!p[c].signed)return void O("Transaction must be signed to be included in a block!");l.splice(r,1);var b=parseInt(t.destination.droppableId.replace("block","")),f=t.destination.index;d[b].transactions.splice(f,0,c),p[c].editable=!1,a.setState({unusedTransactions:l,blocks:d,transactions:p})}else{var h=parseInt(t.source.droppableId.replace("block","")),j=parseInt(t.destination.droppableId.replace("block",""));if(h===j){var v=a.state.blocks,m=v[h].transactions;m.splice(r,1),m.splice(o,0,c),v[h].transactions=m,a.setState({blocks:v})}else{var g=d[h].transactions;g.splice(r,1),d[h].transactions=g;var x=d[j].transactions;x.splice(o,0,c),d[j].transactions=x,a.setState({blocks:d})}}a.recalculateBlocks()}},a.state={accountIdCount:0,accounts:[],transactionIdCount:0,transactions:[],unusedTransactions:[],blockIdCount:2,blocks:[{id:0,prevHash:y,nonce:0,transactions:[],confirmed:!1},{id:1,nonce:0,transactions:[],confirmed:!1}],lastConfirmedBlock:-1,lastUnusedBlock:1},a.recalculateBlocks(),a}return Object(l.a)(n,[{key:"render",value:function(){return Object(b.jsxs)("div",{className:"App",children:[Object(b.jsxs)(h.a,{onDragEnd:this.onDragEnd,children:[Object(b.jsxs)("div",{id:"upperContent",children:[Object(b.jsx)(k,{title:"accounts",accounts:this.state.accounts,droppableId:"accountList",lastConfirmedBlock:this.state.lastConfirmedBlock,className:"accountListContainer",addFunction:this.addAccount,emptyText:"Add some accounts!",dropDisabled:!0}),Object(b.jsx)(k,{title:"transactions",transactions:this.state.transactions,transactionOrder:this.state.unusedTransactions,numberOfAccounts:this.state.accountIdCount,className:"transactionListContainer",droppableId:"transactionList",addFunction:this.addTransaction,signFunction:this.signTransaction,removeSignatureFunction:this.removeSignature})]}),Object(b.jsx)("div",{id:"blockchainContent",children:Object(b.jsx)(w,{blocks:this.state.blocks,transactions:this.state.transactions,confirmFunction:this.confirmBlock})}),Object(b.jsx)("div",{id:"footer",children:"by nils lambertz"})]}),Object(b.jsx)(j.a,{})]})}}]),n}(s.a.Component);o.a.render(Object(b.jsx)(s.a.StrictMode,{children:Object(b.jsx)(L,{})}),document.getElementById("root"))},9:function(t,e,n){"use strict";(function(t){n.d(e,"c",(function(){return u})),n.d(e,"d",(function(){return p})),n.d(e,"e",(function(){return f})),n.d(e,"b",(function(){return h})),n.d(e,"a",(function(){return j}));var a=n(13),s=n.n(a),r=n(21),o=n.n(r),c=n(22),i=n(12);function l(e){return t.from(o.a.encodeBase64(e),"base64").toString("hex")}function d(t){return Object(c.encode)(t)}function u(){var t=s.a.sign.keyPair(),e=l(t.secretKey),n=l(t.publicKey);return{privateKey:e,privateKeyArray:t.secretKey,address:n,addressArray:t.publicKey}}function p(t,e){var n=d(v(t)),a=s.a.sign.detached(n,e);return{signature:l(a),signatureArray:a}}function b(t,e,n){var a=d(v(t));return s.a.sign.detached.verify(a,e,n)}function f(t,e,n){for(var a=0;a<t.transactions.length;a++){var s=e[t.transactions[a]];if(void 0!==s.from){var r=n[s.from];if(void 0!==s.signatureArray&&void 0!==r.addressArray)if(!b(s,s.signatureArray,r.addressArray))return console.log("Error in block "+s.id+": Signature in transaction "+s.id+" could not be verified!"),!1}}return!0}function h(t,e){var n=j(t,e)+t.nonce;return Object(i.sha256)(n)}function j(t,e){for(var n=[],a=0;a<t.transactions.length;a++){var s=e[t.transactions[a]];n.push(v(s))}var r={prevHash:t.prevHash,transactions:n};return JSON.stringify(r)}function v(t){var e={id:t.id,from:t.from,to:t.to,amount:t.amount};return JSON.stringify(e)}}).call(this,n(18).Buffer)}},[[43,1,2]]]);
//# sourceMappingURL=main.4cc6a4f9.chunk.js.map